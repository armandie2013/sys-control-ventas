<section class="bg-white rounded-2xl shadow-md p-6">
  <h1 class="text-2xl font-bold mb-4">Dashboard de usuarios</h1>

  <p class="mb-4 text-gray-700 text-sm">
    Usuario logueado:
    <strong><%= usuario.nombre %> <%= usuario.apellido %> (<%= usuario.rol %>)</strong>
  </p>

  <div class="overflow-x-auto">
    <table class="min-w-full text-sm border">
      <thead class="bg-gray-100">
        <tr>
          <th class="border px-2 py-1 text-left">Nombre</th>
          <th class="border px-2 py-1 text-left">Apellido</th>
          <th class="border px-2 py-1 text-left">Email</th>
          <th class="border px-2 py-1 text-left">Rol</th>
          <th class="border px-2 py-1 text-left">Activo</th>
          <th class="border px-2 py-1 text-left">Creado</th>
          <th class="border px-2 py-1 text-left">Acciones</th>
        </tr>
      </thead>

      <tbody>
        <% if (usuarios && usuarios.length > 0) { %>
          <% usuarios.forEach(u => { %>
            <tr>
              <td class="border px-2 py-1"><%= u.nombre %></td>
              <td class="border px-2 py-1"><%= u.apellido %></td>
              <td class="border px-2 py-1"><%= u.email %></td>
              <td class="border px-2 py-1"><%= u.rol %></td>
              <td class="border px-2 py-1">
                <%= u.activo ? 'Sí' : 'No' %>
              </td>
              <td class="border px-2 py-1">
                <%= u.createdAt ? u.createdAt.toLocaleString('es-AR') : '' %>
              </td>

              <td class="border px-2 py-1">
                <div class="flex flex-wrap gap-2">

                  <!-- Editar -->
                  <a href="/usuarios/editar/<%= u._id %>"
                     class="bg-blue-600 text-white px-2 py-1 rounded text-xs hover:bg-blue-700">
                    Editar
                  </a>

                  <!-- Activar/Desactivar -->
                  <form action="/usuarios/estado/<%= u._id %>?_method=PATCH" method="POST">
                    <button class="bg-yellow-600 text-white px-2 py-1 rounded text-xs hover:bg-yellow-700">
                      <%= u.activo ? 'Desactivar' : 'Activar' %>
                    </button>
                  </form>

                  <!-- Eliminar -->
                  <form action="/usuarios/eliminar/<%= u._id %>?_method=DELETE" method="POST">
                    <button class="bg-red-600 text-white px-2 py-1 rounded text-xs hover:bg-red-700"
                            onclick="return confirm('¿Eliminar usuario?')">
                      Eliminar
                    </button>
                  </form>

                </div>
              </td>
            </tr>
          <% }) %>
        <% } else { %>
          <tr>
            <td colspan="7" class="border px-2 py-2 text-center text-gray-500">
              No hay usuarios registrados.
            </td>
          </tr>
        <% } %>
      </tbody>
    </table>
  </div>
</section>
